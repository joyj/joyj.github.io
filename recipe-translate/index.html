<html>
  <head>

    <link rel="icon" href="http://www.joyjeng.com/smiley.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <!-- jQuery -->
    <script
      src="https://code.jquery.com/jquery-3.1.1.min.js"
      integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
      crossorigin="anonymous"></script>

    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore.js" type="text/javascript"></script>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Bootstrap JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!-- Styles -->
    <link rel="stylesheet" href="core.css">
  </head>

  <body>
    <div class="container">
      <div class="page-header">
        <h1>Recipe Translate</h1>
      </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-md-8">
                <textarea class="form-control" id='recipe-input' rows=10
                          placeholder="Paste ingredients here"></textarea>
            </div>
            <div class="col-md-4">
                <p class="large-text">Advice</p>
                <ul>
                    <li>Paste recipe in input box</li>
                    <li>Lines that start with ### will be ignored</li>
                    <li>Separate ingredients from instructions using ===</li>
                    <li>Edit the ingredients to your substitutions to get more
                        accurate translation and nutrition info (e.g. edit 2% milk to soy milk).</li>
                </ul>
                <p>I recommend using a scale (TODO link) to measure ingredients since it
                is more accurate and saves time washing the dishes! [TODO Read
                about my kitchen setup for more details.]
                </p>
            </div>
        </div>
        <div class="control-panel padding">
            <span>Multipler:</span>
            <input class="span2" id="multiplier-input" size="8" type="text"
                                                                placeholder="1.0">
            <span>Servings:</span>
            <input class="span2" id="servings-input" size="8" type="text"
                                                                placeholder="1">
            <button class="btn btn-default" id="translate-btn"
                                            type="button">Translate</button>
            <span id="nutritional-info"></span>
        </div>
        <div id='translated-ingredients'>
            <table id='ingredients-table' class="table table-striped">
                <tr id='ingredients-table-headers'>
                    <th>
                        <div class="dropdown">
                            <button id="dLabel0" 
                                    class="header-dropdown btn btn-secondary dropdown-toggle"
                                    type="button"
                                    data-toggle="dropdown"
                                    aria-haspopup="true"
                                    aria-expanded="false">
                                Ingredient
                                <span class="caret"></span>
                            </button>
                            <ul class="ingredient-table-dropdown dropdown-menu"
                                aria-labelledby="dLabel0">
                            </ul>
                        </div>
                    </th>
                    <th>
                        <div class="dropdown">
                            <button id="dLabel1" 
                                    class="header-dropdown btn btn-secondary dropdown-toggle"
                                    type="button"
                                    data-toggle="dropdown"
                                    aria-haspopup="true"
                                    aria-expanded="false">
                                Mass (grams)
                                <span class="caret"></span>
                            </button>
                            <ul class="ingredient-table-dropdown dropdown-menu"
                                aria-labelledby="dLabel1">
                            </ul>
                        </div>
                    </th>
                    <th>
                        <div class="dropdown">
                            <button id="dLabel2" 
                                    class="header-dropdown btn btn-secondary dropdown-toggle"
                                    type="button"
                                    data-toggle="dropdown"
                                    aria-haspopup="true"
                                    aria-expanded="false">
                                Volume (US measures)
                                <span class="caret"></span>
                            </button>
                            <ul class="ingredient-table-dropdown dropdown-menu"
                                aria-labelledby="dLabel2">
                            </ul>
                        </div>
                    </th>
                    <th>
                        <div class="dropdown">
                            <button id="dLabel3" 
                                    class="header-dropdown btn btn-secondary dropdown-toggle"
                                    type="button"
                                    data-toggle="dropdown"
                                    aria-haspopup="true"
                                    aria-expanded="false">
                                Original Line
                                <span class="caret"></span>
                            </button>
                            <ul class="ingredient-table-dropdown dropdown-menu"
                                aria-labelledby="dLabel3">
                            </ul>
                        </div>
                    </th>
                    <th>
                        <div class="dropdown">
                            <button id="dLabel4" 
                                    class="header-dropdown btn btn-secondary dropdown-toggle"
                                    type="button"
                                    data-toggle="dropdown"
                                    aria-haspopup="true"
                                    aria-expanded="false">
                                Parsed Info
                                <span class="caret"></span>
                            </button>
                            <ul class="ingredient-table-dropdown dropdown-menu"
                                aria-labelledby="dLabel4">
                            </ul>
                        </div>
                    </th>
                </tr>
            </table>
        </div>
        <div id="instructions">
            <p class="large-text">Instructions</p>
        </div>
    </div>
  </body>
  <script src="ingredients_database.js"></script>
  <script src="utils.js"></script>
  <script src="tests.js"></script>
  <script>
    runTests();

    // TODO Add instructions from instructions.txt

    // Create dropdowns
    $('.ingredient-table-dropdown').html(getDropdownDisplay());
    $(".dropdown-menu li a").click(function(){
        $(this).parents(".dropdown").find('.btn').html(
                $(this).text() + ' <span class="caret"></span>');
        $(this).parents(".dropdown").find('.btn').val($(this).data('value'));
        triggerTranslation();
    });

    // Define translate button actions
    $('#translate-btn').click(triggerTranslation);

    // Populate default example recipe text
    jQuery.get('/recipe-translate/default_input.txt', function(data) {
        $('#recipe-input').html(data);
        triggerTranslation();
    });

    $(function () {
          $('[data-toggle="tooltip"]').tooltip()
    })
  </script>
</html>
